(this["webpackJsonpdesktop-chat"]=this["webpackJsonpdesktop-chat"]||[]).push([[0],{35:function(e,t,a){e.exports=a.p+"static/media/iconmonstr-github-1.1bb02710.svg"},41:function(e,t,a){e.exports=a(56)},55:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(13),s=a.n(r),l=a(1),i=a(25),o=a.n(i),m=a(32),u=a(2);function d(){var e=document.getElementById("chat-window");e&&(e.scrollTop=e.scrollHeight)}function f(e,t,a){return fetch("https://api.intocode.ru:8001/api"+e,{method:t,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()}))}function p(e,t){return f(e,"GET",t)}function v(e,t){return{type:"message/send/started",payload:Object(u.a)(Object(u.a)({},e),{},{nextTempId:t})}}function b(e){return function(t){var a,n;t({type:"message/delete/started"}),(a="/messages",n=e,f(a,"DELETE",n)).then((function(e){t({type:"message/delete/succeed",payload:e})}))}}var E=function(){var e=Object(l.c)((function(e){return e.contacts.loading})),t=Object(l.c)((function(e){return e.application.contactSearchString})),a=Object(l.b)();return c.a.createElement("div",{className:e?"search-contact-disabled":"search-contact"},c.a.createElement("div",{className:"search-contact-icon"},c.a.createElement("i",{className:"material-icons"},"search")),c.a.createElement("div",null,c.a.createElement("input",{disabled:e,placeholder:"Search contact",value:t,onChange:function(e){a({type:"contacts/search/set",payload:e.target.value})}})))},g=a(21),h=a.n(g);var O=function(){return c.a.createElement("div",{className:"recent-chat-skeleton"},c.a.createElement("div",{className:"recent-chat-skeleton-circles"},c.a.createElement(h.a,{count:1,circle:!0,width:35,height:35})),c.a.createElement("div",{className:"recent-chat-skeleton-lines"},c.a.createElement(h.a,{count:1,height:16}),c.a.createElement(h.a,{count:1,height:13})))};var j=function(){return Array(20).fill(1).map((function(e,t){return c.a.createElement(O,{lines:20,key:t})}))},N=a(11),y=a(4);var S=function(e){var t=e.customClass;return c.a.createElement("div",{className:t})};function k(e){var t=e.label,a=e.online,n=e.size,r=e.onclick;return c.a.createElement("div",{className:"avatar-size-".concat(n),onClick:r},a&&c.a.createElement(S,{customClass:"online-indicator-contact"}),t)}k.defaultProps={size:"medium",online:!1};var w=k;function x(e){var t=e.open,a=e.children,n=e.type;return!1===t?null:c.a.createElement("div",{className:"".concat(n,"-dropdown")},a)}x.defaultProps={type:"contact"};var C=x;var _=function(e){var t=e.children,a=e.action;return c.a.createElement("div",{className:"dropdown-item",onClick:a},t)};var I=function(){var e=Object(n.useState)(!1),t=Object(N.a)(e,2),a=t[0],r=t[1];return c.a.createElement("div",{className:"dropdown-menu"},c.a.createElement("button",{className:"dots",onClick:function(e){e.stopPropagation(),r(!a)}},c.a.createElement("i",{className:"material-icons"},"more_horiz")),c.a.createElement(C,{open:a},c.a.createElement(_,null,"Delete"),c.a.createElement(_,null,"Archive"),c.a.createElement(_,null,"Edit")))},M=a(9),T=a.n(M),D=a(34),P=a.n(D);var U=function(e){var t=e.fullname,a=e.lastMessage,r=e._id,s=e.online,i=Object(y.f)().id,o=Object(l.b)(),m=Object(n.useState)(!1),u=Object(N.a)(m,2),d=u[0],f=u[1],p=Object(y.e)(),v=a&&a.read?c.a.createElement("i",{className:"material-icons"},"done_all"):c.a.createElement("i",{className:"material-icons"},"done");T.a.extend(P.a);var b=a?T()(a.time).calendar(null,{sameDay:"HH:mm",lastDay:"[\u0412\u0447\u0435\u0440\u0430]",lastWeek:"dddd",sameElse:"DD.MM.YY"}):null;return c.a.createElement("div",{className:r===i?"chats-item-opened":"chats-item",onClick:function(){r!==i&&(o({type:"message/search/closed"}),p.push(r))},onMouseEnter:function(){f(!0)},onMouseLeave:function(){f(!1)}},c.a.createElement(w,{online:s,label:t[0]}),c.a.createElement("div",{className:"chat-item-center"},c.a.createElement("div",null,t),a&&c.a.createElement("div",{className:"last-message"},a.fromUserId!==r&&v,a.content.length>16?a.content.substring(0,16)+"...":a.content)),c.a.createElement("div",{className:"recent-chats-time"},d?c.a.createElement(I,null):b))};var z=function(){var e=Object(l.c)((function(e){var t=e.application,a=e.contacts,n=t.contactSearchString;return a.items.filter((function(e){return-1!==e.fullname.toUpperCase().indexOf(n.toUpperCase())}))})).sort((function(e,t){var a,n;return T()(null===(a=t.lastMessage)||void 0===a?void 0:a.time)-T()(null===(n=e.lastMessage)||void 0===n?void 0:n.time)}));return Object(l.c)((function(e){return e.contacts.loading}))?c.a.createElement(j,null):e.map((function(e){return c.a.createElement(U,Object.assign({key:e._id},e))}))};var B=function(){return c.a.createElement("div",{className:"sidebar"},c.a.createElement("div",{className:"sidebar-inner"},c.a.createElement(E,null),c.a.createElement(z,null)))},H=a(20);var L=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.application.isMessageSearchStringOpened})),a=Object(l.c)((function(e){return e.application.messageSearchString}));return c.a.createElement("div",null,c.a.createElement("input",{value:a,onChange:function(t){e({type:"message/search/set",payload:t.target.value})},className:t?"message-search-opened":"message-search-closed"}),""===a?null:c.a.createElement("button",{className:"clear-button",onClick:function(){e({type:"message/search/cleared"})}},c.a.createElement("i",{className:"material-icons"},"clear")))};var A=function(){var e=Object(l.c)((function(e){return e.chat.loading})),t=Object(y.f)().id,a=Object(l.c)((function(e){return e.contacts.items.find((function(e){return e._id===t}))})),n=Object(l.b)(),r=function(){n({type:"settings/bar/handled"})};return Object(H.a)("ctrl+p",(function(e){e.preventDefault(),r()})),c.a.createElement("div",{className:"chat-header"},c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){n({type:"message/search/handled"})},className:"message-search-button"},c.a.createElement("i",{className:"material-icons"},"search")),c.a.createElement(L,null)),c.a.createElement("div",null,e?c.a.createElement("div",{className:"update"},c.a.createElement("i",{className:"material-icons refresh"},"autorenew")," Updating..."):c.a.createElement("div",{className:"chat-header-name"},a.fullname,a.online&&c.a.createElement(S,{customClass:"online-indicator-header"}))),c.a.createElement("div",null,c.a.createElement("button",{onClick:r},c.a.createElement("i",{className:"material-icons"},"web"))))};var J=function(e){var t=e.text;return c.a.createElement("div",{className:"info-message"},c.a.createElement("div",{className:"info-message-text"},t))};var W=function(e){var t=e.messageId,a=Object(l.b)(),r=Object(n.useState)(!1),s=Object(N.a)(r,2),i=s[0],o=s[1];return c.a.createElement("div",null,c.a.createElement("button",{className:"dropdown-arrow",onClick:function(){o(!i)}},c.a.createElement("i",{className:"material-icons"},"keyboard_arrow_down")),c.a.createElement(C,{open:i,type:"message"},c.a.createElement(_,{action:function(){a(b(t))}},"Delete")))};function Y(e){var t=e.isInbox,a=e.message,r=Object(l.b)(),s=Object(y.f)().id,i=Object(l.c)((function(e){return e.contacts.items.find((function(e){return e._id===s}))})),o=Object(n.useState)(!1),m=Object(N.a)(o,2),u=m[0],d=m[1],f=t?"inbox":"outbox",p=a.read?c.a.createElement("i",{className:"material-icons"},"done_all"):c.a.createElement("i",{className:"material-icons"},"done");return c.a.createElement("div",{className:"".concat(f,"-message-outer")},t&&c.a.createElement(w,{label:i.fullname[0],size:"small",onclick:function(){r({type:"settings/bar/handled"})}}),c.a.createElement("div",{className:"".concat(f,"-message"),onMouseEnter:function(){d(!0)},onMouseLeave:function(){d(!1)}},c.a.createElement("div",{className:"message-text"},a.content),c.a.createElement("div",{className:"message-time"},T()(a.time).format("HH:mm"),!t&&!a.sending&&p,a.sending&&c.a.createElement("i",{className:"material-icons"},"schedule")),u&&c.a.createElement(W,{messageId:a._id})))}Y.defaultProps={type:"outbox"};var F=Y;var G=function(e){var t=e.message,a=Object(l.c)((function(e){return e.profile._id}));return"info"===t.type?c.a.createElement(J,{text:t.content,key:t._id}):c.a.createElement(F,{message:t,isInbox:t.toUserId===a})};var K=function(){var e=Object(l.c)((function(e){var t=e.application.messageSearchString;return e.chat.items.filter((function(e){return-1!==e.content.toUpperCase().indexOf(t.toUpperCase())}))}));return Object(l.c)((function(e){return e.chat.loading}))?null:c.a.createElement("div",{className:"chat",id:"chat-window"},c.a.createElement("div",{className:"chat-inner"},e.map((function(e){return c.a.createElement(G,{key:e._id,message:e})}))))},q=a(57);var Q=function(e){var t=e.isTyping,a=e.handleClick;return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",null,c.a.createElement("i",{className:"material-icons"},"attach_file")),t?c.a.createElement(q.a,{in:t,timeout:500,classNames:"send-button"},c.a.createElement("button",{onClick:a},c.a.createElement("i",{className:"material-icons"},"send"))):c.a.createElement(q.a,{timeout:1e3,classNames:"mic-button"},c.a.createElement("button",null,c.a.createElement("i",{className:"material-icons"},"mic"))))};var R=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.chat.loading})),a=Object(l.c)((function(e){return e.profile._id})),r=Object(y.f)().id,s=Object(n.useState)(""),i=Object(N.a)(s,2),p=i[0],b=i[1],E=function(){var t;p.length&&e((t={myId:a,contactId:r,type:"text",content:p},function(){var e=Object(m.a)(o.a.mark((function e(a,n){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n().chat.nextTempId,e.next=3,a(v(t,c));case 3:d(),(r="/messages",s=t,f(r,"POST",s)).then((function(e){a({type:"message/send/succeed",payload:Object(u.a)(Object(u.a)({},e),{},{nextTempId:c})})}));case 5:case"end":return e.stop()}var r,s}),e)})));return function(t,a){return e.apply(this,arguments)}}())),b("")};return Object(H.a)("shift+enter",(function(e){e.stopPropagation(),b(p+"\n")})),t?null:c.a.createElement("div",{className:"message-input"},c.a.createElement("div",{className:"message-textarea"},c.a.createElement("textarea",{value:p,placeholder:"Write a message",onChange:function(e){var t=e.target.value;"\n"!==t[t.length-1]&&b(e.target.value)},onKeyDown:function(e){13===e.keyCode&&E()}})),c.a.createElement("div",null,c.a.createElement(Q,{isTyping:p.length>0,handleClick:function(){E()}})))};var V=function(){var e=Object(y.f)().id,t=Object(l.b)(),a=Object(l.c)((function(e){return e.profile._id}));return Object(n.useEffect)((function(){e&&t(function(e,t){return function(a){a({type:"chat/load/started",payload:t}),p("/messages/".concat(e,"/").concat(t)).then((function(e){a({type:"chat/load/success",payload:e}),d()}))}}(a,e))}),[t,a,e]),e?c.a.createElement("div",{className:"chat-window"},c.a.createElement("div",{className:"chat-window-inner"},c.a.createElement(A,null),c.a.createElement(K,null),c.a.createElement(R,null))):c.a.createElement(J,{text:"Please, select a chat to start messaging"})};var X=function(){var e=Object(y.f)().id,t=Object(l.c)((function(t){return t.contacts.items.find((function(t){return t._id===e}))}));return c.a.createElement("div",{className:"contact-info"},c.a.createElement(w,{label:t.fullname[0],size:"big"}),c.a.createElement("div",null,t.fullname),c.a.createElement("div",{className:"username"},"@",t.username),c.a.createElement("div",{className:"contact-info-icons"},c.a.createElement("button",null,c.a.createElement("i",{className:"material-icons"},"call")),c.a.createElement("button",null,c.a.createElement("i",{className:"material-icons"},"videocam")),c.a.createElement("button",null,c.a.createElement("i",{className:"material-icons"},"mail"))))};var Z=function(){var e=Object(y.f)().id,t=Object(l.c)((function(t){return t.contacts.items.find((function(t){return t._id===e}))}));return t.hasOwnProperty("socials")?c.a.createElement("div",null,"Social",c.a.createElement("div",{className:"social"},t.socials.instagram&&c.a.createElement("div",{className:"social-item"},c.a.createElement("div",{className:"social-icon"},c.a.createElement("i",{className:"fa fa-instagram","aria-hidden":"true"})),t.socials.instagram),t.socials.twitter&&c.a.createElement("div",{className:"social-item"},c.a.createElement("div",{className:"social-icon"},c.a.createElement("i",{className:"fa fa-twitter","aria-hidden":"true"})),t.socials.twitter),t.socials.facebook&&c.a.createElement("div",{className:"social-item"},c.a.createElement("div",{className:"social-icon"},c.a.createElement("i",{className:"fa fa-facebook","aria-hidden":"true"})),t.socials.facebook))):null};var $=function(){return c.a.createElement("div",null,"Media",c.a.createElement("div",{className:"media"},c.a.createElement("div",{className:"media-avatar"}),"desktop-chat.pdf"))};var ee=function(){return void 0===Object(y.f)().id?null:c.a.createElement("div",{className:"settings-bar"},c.a.createElement("div",{className:"settings-bar-inner"},c.a.createElement(X,null),c.a.createElement(Z,null),c.a.createElement($,null)))},te=a(35),ae=a.n(te);var ne=function(){return c.a.createElement("a",{href:"https://github.com/Edilbiev/react-desktop-chat"},c.a.createElement("div",{className:"github-outer"},c.a.createElement("img",{src:ae.a,alt:"github",className:"github"})))},ce=a(36),re=a.n(ce);var se=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.profile.loading})),a=Object(l.c)((function(e){return e.contacts.loading})),r=Object(l.c)((function(e){return e.application.settingsBarOpened}));return T.a.extend(re.a),T.a.updateLocale("en",{weekdays:["\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0412\u0442\u043e\u0440\u043d\u0438\u043a","\u0421\u0440\u0435\u0434\u0430","\u0427\u0435\u0442\u0432\u0435\u0440\u0433","\u041f\u044f\u0442\u043d\u0438\u0446\u0430","\u0421\u0443\u0431\u0431\u043e\u0442\u0430"]}),Object(n.useEffect)((function(){e((function(e){e({type:"contacts/load/started"}),p("/contacts").then((function(t){e({type:"contacts/load/success",payload:t})}))})),e((function(e){e({type:"profile/load/started"}),p("/profile").then((function(t){e({type:"profile/load/succeed",payload:t})}))}))}),[e]),t||a?null:c.a.createElement("div",{className:"app"},c.a.createElement(B,null),c.a.createElement(V,null),c.a.createElement(q.a,{in:r,timeout:300,classNames:"transition",unmountOnExit:!0},c.a.createElement(ee,null)),c.a.createElement(ne,null))},le=a(37),ie=a(14),oe=a(38),me=a.n(oe),ue={loading:!0,items:[]};var de=a(19),fe={loading:!1,items:[],nextTempId:1,deleting:!1};var pe={loading:!1,_id:null};var ve={contactSearchString:"",settingsBarOpened:!1,isMessageSearchStringOpened:!1,messageSearchString:""};var be=Object(ie.c)({contacts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"contacts/load/started":return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case"contacts/load/success":return Object(u.a)(Object(u.a)({},e),{},{items:t.payload,loading:!1});default:return e}},chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"chat/load/started":return Object(u.a)(Object(u.a)({},e),{},{items:[],loading:!0});case"chat/load/success":return Object(u.a)(Object(u.a)({},e),{},{items:t.payload,loading:!1});case"message/send/started":return Object(u.a)(Object(u.a)({},e),{},{nextTempId:e.nextTempId+1,items:[].concat(Object(de.a)(e.items),[Object(u.a)(Object(u.a)({},t.payload),{},{sending:!0})])});case"message/send/succeed":var a=t.payload.nextTempId;return Object(u.a)(Object(u.a)({},e),{},{items:e.items.map((function(e){return e.nextTempId===a?t.payload:e}))});case"message/delete/started":return Object(u.a)(Object(u.a)({},e),{},{deleting:!0});case"message/delete/succeed":return Object(u.a)(Object(u.a)({},e),{},{deleting:!1,items:t.payload});default:return e}},profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"profile/load/started":return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case"profile/load/succeed":return Object(u.a)(Object(u.a)({},e),{},{_id:t.payload._id,loading:!1});default:return e}},application:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0,a=t.payload,n=t.type;switch(n){case"contacts/search/set":return Object(u.a)(Object(u.a)({},e),{},{contactSearchString:a});case"settings/bar/handled":return Object(u.a)(Object(u.a)({},e),{},{settingsBarOpened:!e.settingsBarOpened});case"message/search/handled":return Object(u.a)(Object(u.a)({},e),{},{messageSearchString:"",isMessageSearchStringOpened:!e.isMessageSearchStringOpened});case"message/search/closed":return Object(u.a)(Object(u.a)({},e),{},{messageSearchString:"",isMessageSearchStringOpened:!1});case"message/search/cleared":return Object(u.a)(Object(u.a)({},e),{},{messageSearchString:""});case"message/search/set":return Object(u.a)(Object(u.a)({},e),{},{messageSearchString:a});default:return e}}}),Ee=Object(ie.d)(be,Object(ie.a)(le.a,me.a)),ge=(a(53),a(54),a(55),a(10));s.a.render(c.a.createElement(l.a,{store:Ee},c.a.createElement(ge.a,null,c.a.createElement(y.a,{path:"/:id?"},c.a.createElement(se,null)))),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.60be923b.chunk.js.map